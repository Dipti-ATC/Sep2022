<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- bootstrap css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <!-- this is a form from bootstrap website -->
  <body>
    <div
      id="success"
      class="alert alert-success alert-dismissible fade"
      role="alert"
    >
      <strong>Success!</strong> Your form has been successfully submitted
      <button
        type="button"
        class="close"
        data-bs-dismiss="alert"
        aria-label="Close"
      >
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <div
      id="failure"
      class="alert alert-danger alert-dismissible fade"
      role="alert"
    >
      <strong>Error!</strong> Your form has not been sent due to errors
      <button
        type="button"
        class="close"
        data-bs-dismiss="alert"
        aria-label="Close"
      >
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <div class="container">
      <h1>Form Validation using regular exressions</h1>
      <form>
        <div class="form-group">
          <label for="name">Username</label>
          <input
            type="text"
            class="form-control"
            id="name"
            placeholder="Enter your username"
          />
          <small id="namevalid" class="form-text text-muted invalid-feedback">
            Your username must be 2-10 characters long and should not start with
            a number
          </small>
        </div>

        <div class="form-group">
          <label for="email">Email address</label>
          <input
            type="text"
            class="form-control"
            id="email"
            placeholder="Enter your email"
          />
          <small id="emailvalid" class="form-text text-muted invalid-feedback">
            Your email must be a valid email
          </small>
        </div>
        <div class="form-group">
          <label for="car">Select your car</label>
          <select class="form-control" id="car">
            <option>Omni</option>
            <option>Maruti 800</option>
            <option>Ford Titanium</option>
            <option>Audi A4</option>
          </select>
        </div>
        <div class="form-group">
          <label for="address">Enter your address</label>
          <textarea
            class="form-control"
            name="address"
            id="address"
            rows="3"
          ></textarea>
        </div>
        <div class="form-group">
          <label for="address">Enter your mobile number</label>
          <input class="form-control" name="mobile" id="mobile" rows="3" />
          <small id="emailvalid" class="form-text text-muted invalid-feedback">
            Your mobile number must be 10-11 digit long
          </small>
        </div>
        <div class="form-group">
          <label for="exampleFormControlTextarea1">Any other message...</label>
          <textarea
            class="form-control"
            id="exampleFormControlTextarea1"
            rows="3"
          ></textarea>
        </div>
        <button id="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
    <!-- Latest compiled bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      let username = document.getElementById("name");
      let email = document.getElementById("email");
      let mobile = document.getElementById("mobile");
      //  console.log(name,email,mobile);

      let correctUsername = false;
      let correctEmail = false;
      let correctMobile = false;

      username.addEventListener("blur", () => {
        // console.log("name is out of focus");
        let reg = /^[A-Za-z][A-Za-z0-9_]{3,29}$/;
        let text = username.value;
        // console.log(reg, text);
        //username validation
        if (reg.test(text)) {
          console.log("valid name");
          username.classList.remove("is-invalid");
          correctUsername = true;
        } else {
          console.log("invalid name");
          username.classList.add("is-invalid");
          correctUsername = false;
        }
      });
      // email validation
      email.addEventListener("blur", () => {
        let reg = /^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,6}$/;
        let text = email.value;

        if (reg.test(text)) {
          console.log("valid email ");
          email.classList.remove("is-invalid");
          correctemail = true;
        } else {
          console.log("invalid email");
          email.classList.add("is-invalid");
          correctEmail = false;
        }
      });

      // mobile validation
      mobile.addEventListener("blur", () => {
        let reg = /^([0-9]){10,11}$/; //10 is min length and 11 is max
        let text = mobile.value;
        if (reg.test(text)) {
          console.log("valid mobile ");
          mobile.classList.remove("is-invalid");
          correctMobile = true;
        } else {
          console.log("invalid mobile");
          mobile.classList.add("is-invalid");
          correctMobile = false;
        }
      });
      //check the correct input for form submission
      let submission = document.getElementById("submit");

      submission.addEventListener("click", (e) => {
        e.preventDefault();
        let successful = document.getElementById("success");
        let fail = document.getElementById("failure"); // to stop the default behaviour of an element
        if (correctUsername && correctemail && correctMobile) {
          console.log("form submitted");
          successful.classList.add("show");
          fail.classList.remove("show");
        } else {
          console.log("form not submitted");
          successful.classList.remove("show");
          fail.classList.add("show");
        }
      });
    </script>
  </body>
</html>
